<template>
    <div class="w-full h-full overflow-auto">
        <div class="bg"></div>
        <div class="right-0 top-60 z-10 fixed flex flex-col select-none" v-if="isUpload === true">
            <div class="relative flex flex-col">
                <div
                    class="h-14 w-64 flex px-4 items-center bg-white justify-between rounded-lg cursor-pointer mr-0 shadow-2xl border"
                    :class="[{ hoverTrans: openTrans === false }, { closeTrans: openTrans === false }]"
                    @click="clickTrans"
                >
                    <div class="flex items-center" v-if="uploadType === 0">
                        <div class="mr-2">
                            <svg
                                t="1714943972617"
                                class="icon"
                                viewBox="0 0 1024 1024"
                                version="1.1"
                                xmlns="http://www.w3.org/2000/svg"
                                p-id="6806"
                                width="20"
                                height="20"
                            >
                                <path
                                    d="M512.005813 0C229.229613 0 0 229.229613 0 512.06394s229.229613 511.93606 512.005813 511.93606 511.982562-229.229613 511.982562-511.93606S794.770387 0 512.005813 0z m190.65654 475.804321a24.715598 24.715598 0 0 1-34.876197 0L536.663283 344.716324v393.577876a24.669096 24.669096 0 0 1-49.326566 0V344.716324L356.24872 475.804321a24.660958 24.660958 0 0 1-34.876196-34.876196l172.695298-172.672048a26.192023 26.192023 0 0 1 35.864356 0l172.683673 172.683673a24.715598 24.715598 0 0 1 0 34.864571z"
                                    p-id="6807"
                                    fill="#1296db"
                                />
                            </svg>
                        </div>
                        <div class>转写中</div>
                    </div>
                    <div class="flex items-center" v-else>
                        <div class="mr-2">
                            <svg
                                t="1714906781285"
                                class="icon"
                                viewBox="0 0 1024 1024"
                                version="1.1"
                                xmlns="http://www.w3.org/2000/svg"
                                p-id="3240"
                                width="20"
                                height="20"
                            >
                                <path d="M0 0h1024v1024H0V0z" fill="#202425" opacity=".01" p-id="3241" />
                                <path
                                    d="M955.733333 512c0 245.077333-198.656 443.733333-443.733333 443.733333S68.266667 757.077333 68.266667 512 266.922667 68.266667 512 68.266667s443.733333 198.656 443.733333 443.733333z"
                                    fill="#11AA66"
                                    p-id="3242"
                                />
                                <path
                                    d="M512 102.4C285.7984 102.4 102.4 285.7984 102.4 512s183.3984 409.6 409.6 409.6 409.6-183.3984 409.6-409.6S738.2016 102.4 512 102.4zM34.133333 512C34.133333 248.081067 248.081067 34.133333 512 34.133333s477.866667 213.947733 477.866667 477.866667-213.947733 477.866667-477.866667 477.866667S34.133333 775.918933 34.133333 512z"
                                    fill="#11AA66"
                                    p-id="3243"
                                />
                                <path
                                    d="M787.114667 339.285333a51.2 51.2 0 0 1 0 72.362667l-307.2 307.2a51.2 51.2 0 0 1-72.362667 0l-170.666667-170.666667a51.2 51.2 0 0 1 72.362667-72.362666L443.733333 610.235733l271.018667-271.018666a51.2 51.2 0 0 1 72.362667 0z"
                                    fill="#FFFFFF"
                                    p-id="3244"
                                />
                            </svg>
                        </div>
                        <div class>转写完毕</div>
                    </div>
                    <div>
                        <svg
                            t="1714907031563"
                            class="icon"
                            viewBox="0 0 1024 1024"
                            version="1.1"
                            xmlns="http://www.w3.org/2000/svg"
                            p-id="4545"
                            width="20"
                            height="20"
                        >
                            <path d="M510.182608 762.39791 71.456449 261.260306 952.544575 261.260306Z" fill="#8a8a8a" p-id="4546" />
                        </svg>
                    </div>
                </div>

                <div
                    class="top-full right-0 mt-2.5 ml-1.5 max-h-96 w-80 overflow-auto absolute flex bg-white rounded-lg border"
                    v-if="openTrans === true"
                >
                    <div class="transListContainer relative w-full">
                        <ul class="mb-0 pb-4 list-none">
                            <div class="w-full inline-block m-0 p-0 leading-normal text-sm text-black text-opacity-80">
                                <li class="flex list-none m-0 pr-6 pl-5" v-for="(item, index) in UploadList" :key="index">
                                    <div class="flex pt-3.5">
                                        <div v-if="item.state === 0">
                                            <svg
                                                t="1714943972617"
                                                class="icon"
                                                viewBox="0 0 1024 1024"
                                                version="1.1"
                                                xmlns="http://www.w3.org/2000/svg"
                                                p-id="6806"
                                                width="20"
                                                height="20"
                                            >
                                                <path
                                                    d="M512.005813 0C229.229613 0 0 229.229613 0 512.06394s229.229613 511.93606 512.005813 511.93606 511.982562-229.229613 511.982562-511.93606S794.770387 0 512.005813 0z m190.65654 475.804321a24.715598 24.715598 0 0 1-34.876197 0L536.663283 344.716324v393.577876a24.669096 24.669096 0 0 1-49.326566 0V344.716324L356.24872 475.804321a24.660958 24.660958 0 0 1-34.876196-34.876196l172.695298-172.672048a26.192023 26.192023 0 0 1 35.864356 0l172.683673 172.683673a24.715598 24.715598 0 0 1 0 34.864571z"
                                                    p-id="6807"
                                                    fill="#1296db"
                                                />
                                            </svg>
                                        </div>

                                        <div v-if="item.state === 1">
                                            <svg
                                                t="1714906781285"
                                                class="icon"
                                                viewBox="0 0 1024 1024"
                                                version="1.1"
                                                xmlns="http://www.w3.org/2000/svg"
                                                p-id="3240"
                                                width="20"
                                                height="20"
                                            >
                                                <path d="M0 0h1024v1024H0V0z" fill="#202425" opacity=".01" p-id="3241" />
                                                <path
                                                    d="M955.733333 512c0 245.077333-198.656 443.733333-443.733333 443.733333S68.266667 757.077333 68.266667 512 266.922667 68.266667 512 68.266667s443.733333 198.656 443.733333 443.733333z"
                                                    fill="#11AA66"
                                                    p-id="3242"
                                                />
                                                <path
                                                    d="M512 102.4C285.7984 102.4 102.4 285.7984 102.4 512s183.3984 409.6 409.6 409.6 409.6-183.3984 409.6-409.6S738.2016 102.4 512 102.4zM34.133333 512C34.133333 248.081067 248.081067 34.133333 512 34.133333s477.866667 213.947733 477.866667 477.866667-213.947733 477.866667-477.866667 477.866667S34.133333 775.918933 34.133333 512z"
                                                    fill="#11AA66"
                                                    p-id="3243"
                                                />
                                                <path
                                                    d="M787.114667 339.285333a51.2 51.2 0 0 1 0 72.362667l-307.2 307.2a51.2 51.2 0 0 1-72.362667 0l-170.666667-170.666667a51.2 51.2 0 0 1 72.362667-72.362666L443.733333 610.235733l271.018667-271.018666a51.2 51.2 0 0 1 72.362667 0z"
                                                    fill="#FFFFFF"
                                                    p-id="3244"
                                                />
                                            </svg>
                                        </div>
                                    </div>
                                    <div class="ml-2 py-3.5 flex-1 w-0">
                                        <div class="w-full flex justify-between items-center">
                                            <span class="overflow-hidden overflow-ellipsis whitespace-nowrap">{{ item.file_name }}</span>
                                            <span class="cursor-pointer" v-if="item.state !== 0" @click="deleteUploadList(index)">
                                                <svg
                                                    t="1714943421170"
                                                    class="icon"
                                                    viewBox="0 0 1024 1024"
                                                    version="1.1"
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    p-id="4042"
                                                    width="11"
                                                    height="11"
                                                >
                                                    <path
                                                        d="M551.358403 519.66047l402.416186 402.416186L914.421302 961.429942 512.002047 559.013757 109.578698 961.437106 70.224388 922.083819l402.423349-402.423349L70.221318 117.229958l39.35738-39.353286 402.423349 402.426419L914.425396 77.882811l39.353286 39.35738L551.358403 519.66047z"
                                                        fill="#3A2E2E"
                                                        p-id="4043"
                                                    />
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="mt-1 loader" v-if="item.state === 0"></div>
                                        <div class="flex justify-between" v-if="item.state === 1">
                                            <div class="mt-1 text-xs text-gray-500">转写完成，请点击查看</div>
                                            <div class="mt-1 text-xs text-blue-500 cursor-pointer" @click="clickToRecord(item.record_id)">
                                                查看
                                            </div>
                                        </div>

                                        <div class="mt-1 text-xs text-gray-500" v-if="item.state === 2">转写失败，请重试</div>
                                    </div>
                                </li>
                            </div>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="w-full h-1/5 bottom-0 absolute bg-gradient-to-b from-transparent via-blue-50 to-blue-100"></div>
        <div class="pl-20 pr-10 pb-10 z-1">
            <div class="w-full h-32 flex px-20 py-4 text-6xl font-semibold mt-20">
                <div class="flex h-full z-10 pl-20">
                    <div class="text-white select-none">智简会学,&nbsp&nbsp</div>
                </div>
                <div class="scroll h-full z-10">
                    <div
                        v-for="(item, index) in ulList"
                        :key="item.id"
                        :class="!index && play ? 'toUp' : ''"
                        class="truncate h-full text-blue-500 select-none"
                    >
                        {{ item.msg }}
                    </div>
                </div>
            </div>
            <div class="flex select-none">
                <div class="ml-20 z-10">
                    <div class="flex">
                        <div @click="goToVoiceRecord()">
                            <div
                                class="hcard transform transition duration-300 hover:scale-110 rounded-2xl shadow-xl h-64 hover:shadow-xl flex cursor-pointer bg-gradient-to-br bg-blue-100 hover:from-blue-300 hover:via-blue-400 hover:to-blue-500 text-black hover:text-white"
                            >
                                <div class="w-1/2 h-full meet_bg bg-cover bg-no-repeat rounded-l-2xl"></div>
                                <div class="w-1/2 h-full rounded-r-2xl p-4 bx_sd">
                                    <div class="font-semibold text-2xl">会议、课堂实时记录</div>
                                    <div class="font-medium text-base leading-7 mt-3">实时语音转文字</div>
                                    <div class="font-medium text-base leading-7">同步翻译，智能总结要点</div>
                                    <div class="hover_svg bottom-0 right-0 absolute pb-2 pr-2 opacity-0">
                                        <svg
                                            t="1714583281873"
                                            class="icon"
                                            viewBox="0 0 1024 1024"
                                            version="1.1"
                                            xmlns="http://www.w3.org/2000/svg"
                                            p-id="13528"
                                            width="30"
                                            height="30"
                                        >
                                            <path
                                                d="M844.15488 512.70656L571.58656 254.95552c-11.84768-11.84768-29.62432-11.84768-41.48224 0-11.84768 11.84768-11.84768 29.62432 0 41.472L749.34272 503.808H201.2672c-17.77664 0-29.62432 11.84768-29.62432 29.63456 0 17.7664 11.84768 29.62432 29.62432 29.62432h548.08576l-219.2384 207.38048c-11.84768 11.84768-11.84768 29.63456 0 41.48224 5.92896 5.92896 14.81728 8.88832 20.736 8.88832 5.92896 0 14.81728-2.95936 20.736-8.88832l272.55808-257.7408c5.92896-5.92896 8.88832-14.81728 8.88832-20.736 0.01024-5.92896-2.94912-14.81728-8.87808-20.74624z m0 0"
                                                fill="#ffffff"
                                                p-id="13529"
                                            />
                                        </svg>
                                    </div>
                                </div>
                                <div></div>
                            </div>
                        </div>
                        <router-view />
                        <div
                            class="ml-10 hcard transform transition duration-300 hover:scale-110 rounded-2xl shadow-lg h-64 hover:shadow-xl flex cursor-pointer bg-purple-200 bg-gradient-to-br hover:from-purple-300 hover:via-purple-400 hover:to-purple-500 text-black hover:text-white"
                            @click="opendialog('videoDialog')"
                        >
                            <div class="w-1/2 h-full class_bg bg-cover bg-no-repeat rounded-l-2xl"></div>
                            <div class="w-1/2 h-full rounded-r-2xl p-4 bx_sd">
                                <div class="font-semibold text-2xl">音视频上传记录总结</div>
                                <div class="font-medium text-base leading-7 mt-3">音视频转文字</div>
                                <div class="font-medium text-base leading-7">章节速览总结，一键导出</div>
                                <div class="hover_svg bottom-0 right-0 absolute pb-2 pr-2 opacity-0">
                                    <svg
                                        t="1714583281873"
                                        class="icon"
                                        viewBox="0 0 1024 1024"
                                        version="1.1"
                                        xmlns="http://www.w3.org/2000/svg"
                                        p-id="13528"
                                        width="30"
                                        height="30"
                                    >
                                        <path
                                            d="M844.15488 512.70656L571.58656 254.95552c-11.84768-11.84768-29.62432-11.84768-41.48224 0-11.84768 11.84768-11.84768 29.62432 0 41.472L749.34272 503.808H201.2672c-17.77664 0-29.62432 11.84768-29.62432 29.63456 0 17.7664 11.84768 29.62432 29.62432 29.62432h548.08576l-219.2384 207.38048c-11.84768 11.84768-11.84768 29.63456 0 41.48224 5.92896 5.92896 14.81728 8.88832 20.736 8.88832 5.92896 0 14.81728-2.95936 20.736-8.88832l272.55808-257.7408c5.92896-5.92896 8.88832-14.81728 8.88832-20.736 0.01024-5.92896-2.94912-14.81728-8.87808-20.74624z m0 0"
                                            fill="#ffffff"
                                            p-id="13529"
                                        />
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="flex mt-5">
                        <div
                            class="transform transition duration-300 hover:scale-110 rounded-2xl shadow-lg h-64 hover:shadow-xl hcard flex cursor-pointer bg-pink-200 bg-gradient-to-br hover:from-pink-200 hover:via-pink-300 hover:to-pink-400 text-black hover:text-white"
                            @click="opendialog('docUploadDialog')"
                        >
                            <div class="w-1/2 h-full doc_bg bg-cover bg-no-repeat rounded-l-2xl"></div>
                            <div class="w-1/2 h-full rounded-r-2xl p-4 bx_sd">
                                <div class="font-semibold text-2xl">文档、图片一键提取</div>
                                <div class="font-medium text-base leading-7 mt-3">文档、图片总结归纳</div>
                                <div class="font-medium text-base leading-7">拍照上传，轻松阅读</div>
                                <div class="hover_svg bottom-0 right-0 absolute pb-2 pr-2 opacity-0">
                                    <svg
                                        t="1714583281873"
                                        class="icon"
                                        viewBox="0 0 1024 1024"
                                        version="1.1"
                                        xmlns="http://www.w3.org/2000/svg"
                                        p-id="13528"
                                        width="30"
                                        height="30"
                                    >
                                        <path
                                            d="M844.15488 512.70656L571.58656 254.95552c-11.84768-11.84768-29.62432-11.84768-41.48224 0-11.84768 11.84768-11.84768 29.62432 0 41.472L749.34272 503.808H201.2672c-17.77664 0-29.62432 11.84768-29.62432 29.63456 0 17.7664 11.84768 29.62432 29.62432 29.62432h548.08576l-219.2384 207.38048c-11.84768 11.84768-11.84768 29.63456 0 41.48224 5.92896 5.92896 14.81728 8.88832 20.736 8.88832 5.92896 0 14.81728-2.95936 20.736-8.88832l272.55808-257.7408c5.92896-5.92896 8.88832-14.81728 8.88832-20.736 0.01024-5.92896-2.94912-14.81728-8.87808-20.74624z m0 0"
                                            fill="#ffffff"
                                            p-id="13529"
                                        />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <div
                            class="ml-10 transform transition duration-300 hover:scale-110 rounded-2xl shadow-lg h-64 hover:shadow-xl hcard flex cursor-pointer bg-red-100 bg-gradient-to-br hover:from-red-200 hover:via-red-300 hover:to-red-400 text-black hover:text-white"
                            @click="opendialog('liveDialog')"
                        >
                            <div class="w-1/2 h-full live_bg bg-cover bg-no-repeat rounded-l-2xl"></div>

                            <div class="w-1/2 h-full rounded-r-2xl p-4 bx_sd">
                                <div class="font-semibold text-2xl">实时直播,实时记录</div>
                                <div class="font-medium text-base leading-7 mt-3">直播总结，实时笔记</div>
                                <div class="font-medium text-base leading-7">实时交流，实时字幕</div>
                                <div class="hover_svg bottom-0 right-0 absolute pb-2 pr-2 opacity-0">
                                    <svg
                                        t="1714583281873"
                                        class="icon"
                                        viewBox="0 0 1024 1024"
                                        version="1.1"
                                        xmlns="http://www.w3.org/2000/svg"
                                        p-id="13528"
                                        width="30"
                                        height="30"
                                    >
                                        <path
                                            d="M844.15488 512.70656L571.58656 254.95552c-11.84768-11.84768-29.62432-11.84768-41.48224 0-11.84768 11.84768-11.84768 29.62432 0 41.472L749.34272 503.808H201.2672c-17.77664 0-29.62432 11.84768-29.62432 29.63456 0 17.7664 11.84768 29.62432 29.62432 29.62432h548.08576l-219.2384 207.38048c-11.84768 11.84768-11.84768 29.63456 0 41.48224 5.92896 5.92896 14.81728 8.88832 20.736 8.88832 5.92896 0 14.81728-2.95936 20.736-8.88832l272.55808-257.7408c5.92896-5.92896 8.88832-14.81728 8.88832-20.736 0.01024-5.92896-2.94912-14.81728-8.87808-20.74624z m0 0"
                                            fill="#ffffff"
                                            p-id="13529"
                                        />
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="ml-28 z-10 px-2">
                    <div class="clock text-center z-10">
                        <p class="date z-10 select-none">{{ date }}</p>
                        <p class="time z-10 select-none">{{ time }}</p>
                    </div>
                    <div class="text-lg font-normal select-none pl-4">最近</div>
                    <div class="grid w-full place-items-center">
                        <div
                            v-for="(item, index) in recent_items"
                            :key="index"
                            class="relative h-40 w-80 mb-2 rounded-md shadow-lg py-4 px-6 border text-base font-semibold hover_card cursor-pointer"
                        >
                            <div @click="clickToRecord(item.id)">
                                <div class="flex changetotext">
                                    <div class="rencent_title w-full mr-5 select-none" v-if="item.dataType > 1">
                                        {{ item.title.answer }}
                                    </div>
                                    <div class="rencent_title w-full mr-5 select-none" v-else>{{ item.title }}</div>
                                    <div class="rec_icon collectIconWrap">
                                        <el-tooltip class="item" effect="dark" content="收藏" placement="bottom">
                                            <svg
                                                t="1655195283445"
                                                class="cardTitleImg cardTitleImgShow collectHover"
                                                viewBox="0 0 1024 1024"
                                                p-id="6924"
                                                width="16"
                                                height="16"
                                                data-spm-anchor-id="5176.28158796.0.i42.68656ac5pdme4W"
                                            >
                                                <path
                                                    d="M529.066667 165.034667l104.533333 216.405333 206.378667 20.181333a42.666667 42.666667 0 0 1 23.808 74.666667l-162.176 140.885333 46.037333 224.384a42.666667 42.666667 0 0 1-64.298667 44.8l-192.725333-119.637333-192.597333 119.637333a42.666667 42.666667 0 0 1-64.298667-44.8l45.994667-224.384-162.133334-140.842666a42.666667 42.666667 0 0 1 23.808-74.666667L348.16 381.44l104.106667-216.32a42.666667 42.666667 0 0 1 76.8-0.085333z"
                                                    p-id="6925"
                                                    fill="currentColor"
                                                />
                                            </svg>
                                        </el-tooltip>
                                    </div>
                                    <div class="rec_icon bg-gray-50 iconHoverWrap" v-if="item.dataType === 0">
                                        <svg
                                            t="1721300751329"
                                            class="icon"
                                            viewBox="0 0 1024 1024"
                                            version="1.1"
                                            xmlns="http://www.w3.org/2000/svg"
                                            p-id="4260"
                                            width="16"
                                            height="16"
                                        >
                                            <path
                                                d="M849.408 6.656L411.648 140.8c-53.248 15.36-95.744 70.656-95.744 123.392v461.312S284.16 704 213.504 714.24C109.568 729.088 25.6 808.448 25.6 891.904s83.968 134.656 187.904 119.808c103.936-14.848 179.712-91.648 179.712-175.104v-445.44c0-36.864 44.544-52.736 44.544-52.736l387.072-121.344s43.008-14.336 43.008 25.088v367.616s-39.424-22.528-110.08-14.336c-103.936 12.8-187.904 90.624-187.904 174.08S653.824 905.728 757.76 893.44c103.936-12.8 187.904-90.624 187.904-174.08V74.752c-0.512-52.224-43.52-82.944-96.256-68.096z"
                                                fill="#1296db"
                                                p-id="4261"
                                            ></path>
                                        </svg>
                                    </div>
                                    <div class="rec_icon bg-gray-50 iconHoverWrap" v-if="item.dataType === 1">
                                        <svg
                                            t="1714551777145"
                                            class="icon"
                                            viewBox="0 0 1024 1024"
                                            version="1.1"
                                            xmlns="http://www.w3.org/2000/svg"
                                            p-id="4607"
                                            width="16"
                                            height="16"
                                        >
                                            <path
                                                d="M128 128v768h768V128H128z m853.333333-85.333333v938.666666H42.666667V42.666667h938.666666z"
                                                fill="#17abe3"
                                                p-id="4608"
                                            />
                                            <path
                                                d="M341.333333 341.333333l341.333334 170.666667-341.333334 170.666667z"
                                                fill="#17abe3"
                                                p-id="4609"
                                            />
                                        </svg>
                                    </div>
                                    <div class="rec_icon bg-gray-50 iconHoverWrap" v-if="item.dataType > 1">
                                        <svg
                                            t="1721216794948"
                                            class="icon"
                                            viewBox="0 0 1024 1024"
                                            version="1.1"
                                            xmlns="http://www.w3.org/2000/svg"
                                            p-id="4319"
                                            width="16"
                                            height="16"
                                        >
                                            <path
                                                d="M284.434286 971.428571h455.131428c88.722286 0 132.864-45.001143 132.864-134.144V448.146286c0-55.296-5.997714-79.286857-40.283428-114.432L595.565714 93.275429c-32.548571-33.426286-59.136-40.704-107.574857-40.704H284.452571c-88.283429 0-132.864 45.421714-132.864 134.582857v650.130285c0 89.563429 44.580571 134.144 132.864 134.144z m3.419428-68.992c-44.141714 0-67.291429-23.588571-67.291428-66.432V188.434286c0-42.422857 23.149714-66.870857 67.730285-66.870857h190.281143v249.014857c0 53.997714 27.428571 80.566857 80.566857 80.566857h244.297143v384.859428c0 42.843429-22.729143 66.432-67.291428 66.432zM566.857143 386.413714c-16.713143 0-23.588571-6.838857-23.588572-23.990857V134.857143l246.857143 251.574857z"
                                                p-id="4320"
                                                fill="#1296db"
                                            ></path>
                                        </svg>
                                    </div>
                                </div>
                                <div class="mt-5 overflow-hidden flex-wrap flex select-none h-6" v-if="item.dataType > 1">
                                    <el-tag v-for="tag in item.keyword.answer" :key="tag.id" class="flex mr-1">{{ tag.desc }}</el-tag>
                                </div>
                                <div class="mt-5 overflow-hidden flex-wrap flex select-none h-6" v-else>
                                    <el-tag v-for="tag in item.keyword.answer" :key="tag.id" class="flex mr-1">{{ tag }}</el-tag>
                                </div>
                            </div>
                            <div class="mt-4 flex justify-between text-xs font-normal text-gray-400 select-none">
                                <div></div>
                                <div>{{ item.updatetime }}</div>
                            </div>
                            <div class="absolute bottom-0 left-0 w-full z-1">
                                <div class="h-8 flex justify-between px-14 bg-white label_b opacity-0 cursor-default">
                                    <div class="text-black cursor-pointer" @click="rename">
                                        <el-tooltip class="item" effect="dark" content="重命名" placement="bottom">
                                            <svg
                                                t="1655194314953"
                                                class="HoverImg"
                                                viewBox="0 0 1024 1024"
                                                p-id="5876"
                                                width="20"
                                                height="20"
                                            >
                                                <path
                                                    d="M532.394667 259.84l235.306666 220.245333-292.138666 291.712h341.290666V853.333333H170.666667v-0.042666h-2.858667l1.066667-227.968 363.52-365.482667zM750.933333 201.557333l5.845334 5.504 142.08 142.08-81.109334 80.896-235.52-220.416 2.56-2.56a121.6 121.6 0 0 1 166.144-5.504z"
                                                    p-id="5877"
                                                    fill="currentColor"
                                                />
                                            </svg>
                                        </el-tooltip>
                                    </div>

                                    <div class="text-black cursor-pointer">
                                        <el-tooltip class="item" effect="dark" content="导出" placement="bottom">
                                            <svg
                                                t="1714569161423"
                                                class="icon"
                                                viewBox="0 0 1024 1024"
                                                version="1.1"
                                                xmlns="http://www.w3.org/2000/svg"
                                                p-id="11322"
                                                width="20"
                                                height="20"
                                            >
                                                <path
                                                    d="M512 640.64a42.666667 42.666667 0 0 0 42.666667-42.666667v-341.333333h130.986666a21.333333 21.333333 0 0 0 14.250667-5.461333l2.688-2.901334a21.333333 21.333333 0 0 0-4.010667-29.909333l-165.717333-126.464a32 32 0 0 0-38.912 0.042667L329.472 218.453333a21.333333 21.333333 0 0 0 12.970667 38.229334H469.333333v341.333333a42.666667 42.666667 0 0 0 42.666667 42.666667z m229.674667-298.368a42.666667 42.666667 0 0 0 4.992 85.034667H853.333333v426.666666H170.666667v-426.666666h106.666666a42.666667 42.666667 0 0 0 0-85.333334H170.666667a85.333333 85.333333 0 0 0-85.333334 85.333334v426.666666a85.333333 85.333333 0 0 0 85.333334 85.333334h682.666666a85.333333 85.333333 0 0 0 85.333334-85.333334v-426.666666a85.333333 85.333333 0 0 0-85.333334-85.333334h-106.666666z"
                                                    fill="#000000"
                                                    p-id="11323"
                                                />
                                            </svg>
                                        </el-tooltip>
                                    </div>
                                    <div class="text-black cursor-pointer">
                                        <el-tooltip class="item" effect="dark" content="删除" placement="bottom">
                                            <svg
                                                t="1714569254710"
                                                class="icon"
                                                viewBox="0 0 1024 1024"
                                                version="1.1"
                                                xmlns="http://www.w3.org/2000/svg"
                                                p-id="12340"
                                                width="20"
                                                height="20"
                                            >
                                                <path
                                                    d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zM864 256H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"
                                                    p-id="12341"
                                                />
                                            </svg>
                                        </el-tooltip>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <el-dialog
            :visible="videoDialogVisible"
            v-if="videoDialogVisible"
            title="上传音视频"
            width="30%"
            top="25vh"
            :close-on-click-modal="false"
            @close="closeVideoDialog"
            :destroy-on-close="true"
            class="select-none"
        >
            <div class="items-center">
                <div
                    class="videodialogcard flex items-center bg-purple-100 bg-opacity-95 hover:bg-purple-200 cursor-pointer"
                    @click="
                        videoDialogVisible = false;
                        videoUploadDialogVisible = true;
                    "
                >
                    <svg
                        t="1714675464716"
                        class="icon ml-5 mr-10"
                        viewBox="0 0 1024 1024"
                        version="1.1"
                        xmlns="http://www.w3.org/2000/svg"
                        p-id="6860"
                        width="60"
                        height="60"
                    >
                        <path
                            d="M960.711582 372.46606l0 523.083429c0 36.684504-29.738301 66.423829-66.422805 66.423829L130.420375 961.973318c-36.684504 0-66.422805-29.738301-66.422805-66.423829L63.99757 131.682112c0-36.684504 29.738301-66.422805 66.422805-66.422805l523.083429 0 0-0.261966 0.261966 0.261966 30.127158 0 1.151219 1.152243 1.671059-1.670036L956.784132 334.808392l-1.671059 1.671059 5.598508 5.597485 0 30.127158 0.261966 0.261966L960.711582 372.46606zM695.018314 131.753743l0 116.169813c0 45.855374 37.173644 83.029018 83.029018 83.029018l116.169813 0L695.018314 131.753743zM919.197072 372.46606 736.532823 372.46606c-45.855374 0-83.029018-37.173644-83.029018-83.029018L653.503804 106.772792 155.329694 106.772792c-27.513634 0-49.817616 22.303982-49.817616 49.817616l0 714.050786c0 27.513634 22.303982 49.817616 49.817616 49.817616l714.050786 0c27.513634 0 49.817616-22.303982 49.817616-49.817616L919.198096 372.46606zM861.077374 845.73085l-49.817616 0c-4.585435 0-8.303106-3.714602-8.303106-8.30106l0-49.819662c0-4.582365 3.717671-8.30106 8.303106-8.30106l49.817616 0c4.585435 0 8.303106 3.718695 8.303106 8.30106l0 49.819662C869.38048 842.016249 865.662809 845.73085 861.077374 845.73085zM861.077374 704.58418l-49.817616 0c-4.585435 0-8.303106-3.718695-8.303106-8.305153l0-49.814546c0-4.586458 3.717671-8.305153 8.303106-8.305153l49.817616 0c4.585435 0 8.303106 3.718695 8.303106 8.305153l0 49.814546C869.38048 700.865485 865.662809 704.58418 861.077374 704.58418zM861.077374 563.434439l-49.817616 0c-4.585435 0-8.303106-3.718695-8.303106-8.305153l0-49.814546c0-4.586458 3.717671-8.305153 8.303106-8.305153l49.817616 0c4.585435 0 8.303106 3.718695 8.303106 8.305153l0 49.814546C869.38048 559.715745 865.662809 563.434439 861.077374 563.434439zM654.699026 535.981181 436.936397 670.177556c-7.795547 4.804423-17.503653 7.468089-27.588335 8.499581-2.730181 0.60989-5.634324 0.9967-8.705266 0.9967-3.207042 0-6.245238-0.406253-9.075703-1.067308-1.24741-0.140193-2.524496-0.101307-3.756557-0.296759L387.810536 348.922854c1.231037-0.195451 2.509147-0.156566 3.756557-0.296759 2.830465-0.662079 5.868661-1.067308 9.075703-1.067308 3.070942 0 5.976108 0.387833 8.705266 0.9967 10.084683 1.032516 19.792788 3.695159 27.588335 8.499581l217.761606 134.195352C674.742525 503.602749 674.742525 523.628852 654.699026 535.981181zM600.258113 502.43311l-173.951821-107.197464 0 236.761332 173.951821-107.197464C610.280374 518.622838 610.280374 508.609787 600.258113 502.43311zM213.449393 845.73085l-49.817616 0c-4.585435 0-8.303106-3.714602-8.303106-8.30106l0-49.819662c0-4.582365 3.717671-8.30106 8.303106-8.30106l49.817616 0c4.585435 0 8.303106 3.718695 8.303106 8.30106l0 49.819662C221.7525 842.016249 218.035852 845.73085 213.449393 845.73085zM213.449393 704.58418l-49.817616 0c-4.585435 0-8.303106-3.718695-8.303106-8.305153l0-49.814546c0-4.586458 3.717671-8.305153 8.303106-8.305153l49.817616 0c4.585435 0 8.303106 3.718695 8.303106 8.305153l0 49.814546C221.7525 700.865485 218.035852 704.58418 213.449393 704.58418zM213.449393 563.434439l-49.817616 0c-4.585435 0-8.303106-3.718695-8.303106-8.305153l0-49.814546c0-4.586458 3.717671-8.305153 8.303106-8.305153l49.817616 0c4.585435 0 8.303106 3.718695 8.303106 8.305153l0 49.814546C221.7525 559.715745 218.035852 563.434439 213.449393 563.434439zM213.449393 413.982616l-49.817616 0c-4.585435 0-8.303106-3.719718-8.303106-8.306176l0-49.814546c0-4.586458 3.717671-8.306176 8.303106-8.306176l49.817616 0c4.585435 0 8.303106 3.719718 8.303106 8.306176l0 49.814546C221.7525 410.262898 218.035852 413.982616 213.449393 413.982616zM213.449393 272.831852l-49.817616 0c-4.585435 0-8.303106-3.719718-8.303106-8.302083l0-49.818639c0-4.586458 3.717671-8.302083 8.303106-8.302083l49.817616 0c4.585435 0 8.303106 3.715625 8.303106 8.302083l0 49.818639C221.7525 269.112134 218.035852 272.831852 213.449393 272.831852z"
                            p-id="6861"
                        />
                    </svg>
                    <div>
                        <p class="text-black text-lg font-medium">上传本地音视频文件</p>
                        <p class="text-sm text-gray-400">音视频转文字，提炼总结，一键导出</p>
                    </div>
                </div>

                <div
                    class="videodialogcard flex items-center bg-blue-100 bg-opacity-95 hover:bg-blue-200 cursor-pointer"
                    @click="
                        videoDialogVisible = false;
                        videoUrlUploadDialogVisible = true;
                    "
                >
                    <svg
                        t="1714675580159"
                        class="icon ml-5 mr-10"
                        viewBox="0 0 1024 1024"
                        version="1.1"
                        xmlns="http://www.w3.org/2000/svg"
                        p-id="8715"
                        width="60"
                        height="60"
                    >
                        <path
                            d="M913.937279 113.328092c-32.94432-32.946366-76.898391-51.089585-123.763768-51.089585s-90.819448 18.143219-123.763768 51.089585L416.737356 362.999454c-32.946366 32.94432-51.089585 76.898391-51.089585 123.763768s18.143219 90.819448 51.087539 123.763768c25.406646 25.40767 57.58451 42.144866 93.053326 48.403406 1.76418 0.312108 3.51915 0.463558 5.249561 0.463558 14.288424 0 26.951839-10.244318 29.519314-24.802896 2.879584-16.322757-8.016581-31.889291-24.339338-34.768875-23.278169-4.106528-44.38386-15.081487-61.039191-31.736818-21.61018-21.61018-33.509185-50.489928-33.509185-81.322144s11.899004-59.711963 33.509185-81.322144l15.864316-15.864316c-0.267083 1.121544-0.478907 2.267647-0.6191 3.440355-1.955538 16.45988 9.800203 31.386848 26.260084 33.344432 25.863041 3.072989 49.213865 14.378475 67.527976 32.692586 21.608134 21.608134 33.509185 50.489928 33.509185 81.322144s-11.901051 59.71401-33.509185 81.322144L318.53987 871.368764c-21.61018 21.61018-50.489928 33.511231-81.322144 33.511231-30.832216 0-59.711963-11.901051-81.322144-33.511231-21.61018-21.61018-33.509185-50.489928-33.509185-81.322144s11.899004-59.711963 33.509185-81.322144l169.43597-169.438017c11.720949-11.718903 11.720949-30.722722 0-42.441625-11.718903-11.718903-30.722722-11.718903-42.441625 0L113.452935 666.282852c-32.946366 32.94432-51.089585 76.898391-51.089585 123.763768 0 46.865377 18.143219 90.819448 51.089585 123.763768 32.94432 32.946366 76.898391 51.091632 123.763768 51.091632s90.819448-18.145266 123.763768-51.091632l249.673409-249.671363c32.946366-32.94432 51.089585-76.898391 51.089585-123.763768-0.002047-46.865377-18.145266-90.819448-51.089585-123.763768-27.5341-27.536146-64.073294-45.240367-102.885252-49.854455-3.618411-0.428765-7.161097-0.196475-10.508331 0.601704l211.589023-211.589023c21.61018-21.61018 50.489928-33.509185 81.322144-33.509185s59.711963 11.899004 81.322144 33.509185c21.61018 21.61018 33.509185 50.489928 33.509185 81.322144s-11.899004 59.711963-33.509185 81.322144l-150.180418 150.182464c-11.720949 11.718903-11.720949 30.722722 0 42.441625 11.718903 11.718903 30.722722 11.718903 42.441625 0l150.180418-150.182464c32.946366-32.94432 51.089585-76.898391 51.089585-123.763768C965.026864 190.226482 946.882622 146.272411 913.937279 113.328092z"
                            fill="#272636"
                            p-id="8716"
                        />
                    </svg>
                    <div>
                        <p class="text-black text-lg font-medium select-none">输入解析音视频链接</p>
                        <p class="text-sm text-gray-400 select-none">自动解析，自动总结</p>
                    </div>
                </div>
            </div>
        </el-dialog>

        <el-dialog
            :visible="videoUploadDialogVisible"
            v-if="videoUploadDialogVisible"
            title="上传音视频"
            width="30%"
            top="30vh"
            :close-on-click-modal="false"
            @close="closeVideoUploadDialog"
            class="select-none"
            :destroy-on-close="true"
        >
            <div class="flex">
                <div class="overflow-hidden">
                    <el-upload
                        ref="videoUpload"
                        drag
                        action="#"
                        multiple
                        :limit="5"
                        :auto-upload="false"
                        :on-exceed="handleVideoExceed"
                        :file-list="videoFileList"
                        :http-request="handleVideoFileUpload"
                        :on-change="handleVideoChange"
                        :on-remove="handleVideoRemove"
                        :on-success="handleVideoSuccess"
                        accept=".mp3, .mp4"
                    >
                        <i class="el-icon-upload"></i>
                        <div class="el-upload__text">
                            将文件拖到此处，或
                            <em>点击上传</em>
                        </div>
                        <div class="el-upload__tip flex justify-between" slot="tip">
                            <div>目前仅支持mp4，mp3文件，文件时长最长为1小时,不超过500M</div>
                            <div>{{ videoFileCount }}/5</div>
                        </div>
                    </el-upload>
                </div>
                <div class="ml-5">
                    <div class="mb-5">
                        <div>音视频语言</div>
                        <div>
                            <el-radio-group v-model="lang" @change="changeLang">
                                <el-radio-button label="0">中文</el-radio-button>
                                <el-radio-button label="1">英语</el-radio-button>
                            </el-radio-group>
                        </div>
                    </div>
                    <div class="mb-5">
                        <div class>翻译</div>
                        <el-select v-model="transValue">
                            <el-option v-for="item in uploadOptions" :key="item.value" :label="item.label" :value="item.value"></el-option>
                        </el-select>
                        <div></div>
                    </div>
                    <div class="flex justify-center">
                        <el-button class="w-1/2" type="primary" @click.stop="clickUploadVideo">
                            上传
                            <i class="el-icon-upload el-icon--right"></i>
                        </el-button>
                    </div>
                </div>
            </div>
        </el-dialog>

        <el-dialog
            :visible="videoUrlUploadDialogVisible"
            v-if="videoUrlUploadDialogVisible"
            title="上传音视频链接"
            width="30%"
            top="30vh"
            :close-on-click-modal="false"
            @close="closeVideoUrlUploadDialog"
            class="select-none"
            :destroy-on-close="true"
        >
            <div>
                <el-input
                    :autosize="{ minRows: 12, maxRows: 12 }"
                    resize="none"
                    v-model="videoUrl"
                    min="1"
                    type="textarea"
                    placeholder="请输入音视频链接"
                ></el-input>
            </div>

            <div class="flex justify-center mt-5">
                <el-button class="w-1/4" type="primary" @click.stop="submitVideoUrl">
                    上传
                    <i class="el-icon-upload el-icon--right"></i>
                </el-button>
            </div>
        </el-dialog>

        <el-dialog
            :visible="docUploadDialogVisible"
            v-if="docUploadDialogVisible"
            title="上传文档、图片"
            width="25%"
            top="30vh"
            :close-on-click-modal="false"
            @close="closeDocUploadDialog"
            class="select-none"
            :destroy-on-close="true"
        >
            <div class="flex justify-center -mt-10">
                <el-menu
                    :default-active="docUploadDialogAcitveIndex"
                    class="el-menu-demo"
                    background-color="#fff"
                    mode="horizontal"
                    @select="handleDocTypeSelect"
                    style="border-bottom: 0px !important"
                >
                    <el-menu-item index="0">文档阅读</el-menu-item>
                    <el-menu-item index="1">网页阅读</el-menu-item>
                </el-menu>
            </div>
            <div class="w-full flex justify-center mt-2" v-if="docUploadDialogAcitveIndex === '0'">
                <el-upload
                    ref="fileUpload"
                    drag
                    class="upload-demo"
                    action="handleFileFileUpload"
                    multiple
                    :limit="1"
                    :file-list="fileFileList"
                    :http-request="handleFileFileUpload"
                    accept=".pdf, .doc, .docx, .img, .png, jepg"
                >
                    <i class="el-icon-upload"></i>
                    <div class="el-upload__text">
                        将文件拖到此处，或
                        <em>点击上传</em>
                    </div>
                    <div class="el-upload__tip" slot="tip">
                        <div class="text-gray-400">文件格式：PDF/ Word/ 图片/ HTML</div>
                        <div class="text-gray-400">文档大小：文件最大支持5M，图片最大支持5M</div>
                        <div class="text-gray-400">文档页数：目前只支持简单pdf</div>
                    </div>
                </el-upload>
            </div>

            <div v-else class="select-none">
                <div class="mb-3">
                    <el-input
                        :autosize="{ minRows: 12, maxRows: 12 }"
                        resize="none"
                        v-model="htmlUrl"
                        min="1"
                        type="textarea"
                        placeholder="请输入或粘贴网址"
                    ></el-input>
                </div>

                <div class="text-gray-400 mb-3 text-xs">单次上传一个网址，请确保添加网址符合网络规范</div>
                <div class="flex justify-center">
                    <el-button class="w-1/4" type="primary" @click="submitFileURL">
                        上传
                        <i class="el-icon-upload el-icon--right"></i>
                    </el-button>
                </div>
            </div>
        </el-dialog>

        <el-dialog
            :visible="liveDialogVisible"
            v-if="liveDialogVisible"
            title="实时直播"
            width="25%"
            top="30vh"
            :close-on-click-modal="false"
            @close="closeLiveDialog"
            class="select-none"
            :destroy-on-close="true"
        >
            <div class="w-full flex mt-2 justify-between">
                <div
                    class="w-2/5 bg-blue-300 h-40 ml-8 rounded-xl flex justify-center items-center hover:bg-blue-500 cursor-pointer"
                    @click="
                        liveDialogVisible = false;
                        createLiveDialogVisible = true;
                        roomCreateForm.roomNumber = generateRandomString();
                    "
                >
                    <div>
                        <div class="text-xl text-white">开启直播</div>
                        <div class="flex justify-center">
                            <svg
                                t="1714991848004"
                                class="icon"
                                viewBox="0 0 1024 1024"
                                version="1.1"
                                xmlns="http://www.w3.org/2000/svg"
                                p-id="5416"
                                width="40"
                                height="40"
                            >
                                <path
                                    d="M897.536 264.704H655.36l142.848-145.408c10.752-10.752 10.24-28.16-0.512-38.912-10.752-10.752-28.16-10.24-38.912 0.512L578.56 264.704H448.512L267.776 80.896c-10.752-10.752-28.16-10.752-38.912-0.512-10.752 10.752-10.752 28.16-0.512 38.912l142.848 145.408H129.024c-55.296 0-100.864 45.056-100.864 100.864v481.792c0 55.296 45.056 100.864 100.864 100.864h768.512c55.296 0 100.864-45.056 100.864-100.864V365.568c0-55.808-45.056-100.864-100.864-100.864z m46.08 582.656c0 25.088-20.48 45.568-45.568 45.568H129.024c-25.088 0-45.568-20.48-45.568-45.568V365.568c0-25.088 20.48-45.568 45.568-45.568h768.512c25.088 0 45.568 20.48 45.568 45.568v481.792z"
                                    p-id="5417"
                                    fill="#ffffff"
                                />
                                <path
                                    d="M653.312 582.656L415.744 445.44c-8.704-5.12-18.944-5.12-27.648 0-8.704 5.12-13.824 13.824-13.824 23.552v274.432c0 9.728 5.12 18.944 13.824 23.552 4.096 2.56 9.216 3.584 13.824 3.584 4.608 0 9.728-1.024 13.824-3.584l237.568-137.216c8.704-5.12 13.824-13.824 13.824-23.552s-5.12-18.944-13.824-23.552zM429.568 696.32v-179.2l155.136 89.6L429.568 696.32z"
                                    p-id="5418"
                                    fill="#ffffff"
                                />
                            </svg>
                        </div>
                    </div>
                </div>
                <div
                    class="w-2/5 bg-purple-300 hover:bg-purple-500 h-40 mr-8 rounded-xl flex justify-center items-center cursor-pointer"
                    @click="
                        liveDialogVisible = false;
                        inLiveDialogVisible = true;
                    "
                >
                    <div>
                        <div class="text-xl text-white">加入房间</div>
                        <div class="flex justify-center">
                            <svg
                                t="1714994529313"
                                class="icon"
                                viewBox="0 0 1024 1024"
                                version="1.1"
                                xmlns="http://www.w3.org/2000/svg"
                                p-id="14834"
                                width="40"
                                height="40"
                            >
                                <path
                                    d="M952.54478 242.151024h-339.418536L742.150244 113.276878c16.67122-14.435902 16.67122-40.56039 0-57.443902-14.435902-16.683707-40.597854-16.683707-57.418927 0L506.692683 233.784195 393.141073 120.257561c-14.435902-16.67122-40.785171-16.67122-57.45639 0-16.67122 14.435902-16.67122 40.56039 0 57.443902l64.349658 64.462049H70.281366c-30.994732 0-57.344 26.199415-57.344 57.319025v592.60878c0 31.00722 26.349268 57.319024 57.344 57.319024h882.238439c31.094634 0 57.368976-26.311805 57.368975-92.859317V263.917268c0.074927 4.333268-26.099512-21.766244-57.344-21.766244z m-16.671219 599.701854c0 19.118829-16.78361 38.212683-38.325073 38.212683H125.390049a37.750634 37.750634 0 0 1-38.325073-38.212683V349.658537a37.912976 37.912976 0 0 1 38.337561-38.325074H478.033171c4.945171 1.111415 10.065171 1.111415 14.997853 0h25.674927a34.965854 34.965854 0 0 0 15.110244 0H897.498537a37.912976 37.912976 0 0 1 38.337561 38.337561v492.181854h0.024975z"
                                    fill="#ffffff"
                                    p-id="14835"
                                />
                                <path
                                    d="M407.102439 734.282927h-55.096195c-2.884683 0-5.794341-2.747317-5.794342-5.769366V479.219512c0-2.872195 2.772293-5.906732 5.794342-5.906732h55.196097c2.897171 0 5.806829 2.884683 5.80683 5.906732v249.431415a6.218927 6.218927 0 0 1-5.906732 5.619512z m-206.086244-75.301464V479.207024c0-2.872195-2.772293-5.906732-5.769366-5.906731h-55.196097c-2.78478 0-5.806829 2.884683-5.80683 5.906731V731.53561c0 2.747317 2.872195 5.719415 5.794342 5.719414h156.647024c2.872195 0 5.894244-2.84722 5.894244-5.719414v-58.168195c0-2.772293-2.984585-5.756878-5.894244-5.756878h-84.117853c-8.566634-2.84722-11.55122-5.619512-11.55122-8.641561zM883.012683 525.53678v-49.351804a6.119024 6.119024 0 0 0-5.831805-5.756878H737.891902c-2.78478 0-5.769366 2.772293-5.769365 5.756878v252.316097c0 2.909659 2.84722 5.756878 5.769365 5.756878h139.288976c2.909659 0 5.831805-2.747317 5.831805-5.756878v-49.314341c0-2.909659-2.772293-5.906732-5.831805-5.906732h-69.507122c-2.909659 0-5.906732-2.772293-5.906732-5.74439v-29.021659c0-2.872195 2.922146-5.756878 5.906732-5.756878h69.507122c2.909659 0 5.831805-2.872195 5.831805-5.906732V586.302439a6.119024 6.119024 0 0 0-5.831805-5.756878h-69.507122c-2.909659 0-5.906732-2.872195-5.906732-5.906732V545.717073c0-2.772293 2.922146-5.756878 5.906732-5.756878h69.507122c2.947122-5.731902 5.831805-8.491707 5.831805-14.398439z m-269.911415-46.329756v29.009171l-34.840975 139.189073c-2.772293 5.894244-11.413854 5.894244-11.413854 0l-34.878439-139.189073v-29.009171c0-2.872195-2.922146-5.906732-5.906732-5.906731h-54.996292c-2.872195 0-5.906732 2.884683-5.906732 5.906731v34.766049l60.865561 223.281951h101.650732-14.535805 14.535805l60.903024-223.281951v-34.766049c0-2.872195-2.872195-5.906732-5.906732-5.906731h-54.996292c-11.588683-2.772293-14.573268 0.037463-14.573269 5.906731z"
                                    fill="#ffffff"
                                    p-id="14836"
                                />
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        </el-dialog>

        <el-dialog
            :visible="createLiveDialogVisible"
            v-if="createLiveDialogVisible"
            title="创建房间"
            width="20%"
            top="30vh"
            :close-on-click-modal="false"
            @close="closeCreateLiveDialog"
            class="select-none"
            :destroy-on-close="true"
        >
            <div class="px-2">
                <div class="flex items-center w-full mb-5">
                    <div class="w-1/6">房间名:</div>
                    <div class="w-5/6">
                        <el-input
                            class="w-full"
                            type="text"
                            placeholder="请输入内容"
                            v-model="roomCreateForm.roomName"
                            maxlength="15"
                            show-word-limit
                        ></el-input>
                    </div>
                </div>

                <div class="flex items-center w-full mb-5">
                    <div class="w-1/6">是否公开</div>
                    <div class="w-5/6">
                        <el-radio v-model="roomCreateForm.openLiveRadio" label="0">公开</el-radio>
                        <el-radio v-model="roomCreateForm.openLiveRadio" label="1">私密</el-radio>
                    </div>
                </div>

                <div class="flex items-center w-full mb-5" v-if="roomCreateForm.openLiveRadio === '1'">
                    <div class="w-1/6">密码:</div>
                    <div class="w-5/6">
                        <el-input
                            class="w-full"
                            type="text"
                            placeholder="请输入房间密码"
                            v-model="roomCreateForm.roomPassword"
                            maxlength="8"
                            show-word-limit
                        ></el-input>
                    </div>
                </div>

                <div class="flex items-center w-full mb-5">
                    <div class="mr-2">实时记录</div>
                    <div>
                        <el-radio v-model="roomCreateForm.liveRecordRadio" label="0">开启</el-radio>
                        <el-radio v-model="roomCreateForm.liveRecordRadio" label="1">关闭</el-radio>
                    </div>
                </div>

                <div class="flex items-center w-full mb-5">
                    <div class="flex">
                        <div class="mr-2">房间号:</div>
                        <div id="roomNumber" class="mr-1">{{ roomCreateForm.roomNumber }}</div>
                        <div class="cursor-pointer" @click="copyRoomNumber">
                            <svg
                                t="1715003398431"
                                class="icon"
                                viewBox="0 0 1024 1024"
                                version="1.1"
                                xmlns="http://www.w3.org/2000/svg"
                                p-id="3497"
                                width="15"
                                height="15"
                            >
                                <path
                                    d="M394.666667 106.666667h448a74.666667 74.666667 0 0 1 74.666666 74.666666v448a74.666667 74.666667 0 0 1-74.666666 74.666667H394.666667a74.666667 74.666667 0 0 1-74.666667-74.666667V181.333333a74.666667 74.666667 0 0 1 74.666667-74.666666z m0 64a10.666667 10.666667 0 0 0-10.666667 10.666666v448a10.666667 10.666667 0 0 0 10.666667 10.666667h448a10.666667 10.666667 0 0 0 10.666666-10.666667V181.333333a10.666667 10.666667 0 0 0-10.666666-10.666666H394.666667z m245.333333 597.333333a32 32 0 0 1 64 0v74.666667a74.666667 74.666667 0 0 1-74.666667 74.666666H181.333333a74.666667 74.666667 0 0 1-74.666666-74.666666V394.666667a74.666667 74.666667 0 0 1 74.666666-74.666667h74.666667a32 32 0 0 1 0 64h-74.666667a10.666667 10.666667 0 0 0-10.666666 10.666667v448a10.666667 10.666667 0 0 0 10.666666 10.666666h448a10.666667 10.666667 0 0 0 10.666667-10.666666v-74.666667z"
                                    fill="#707070"
                                    p-id="3498"
                                />
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="w-full flex justify-center">
                    <el-button type="primary" @click="clickCreateRoom">创建</el-button>
                </div>
            </div>
        </el-dialog>

        <el-dialog
            :visible="inLiveDialogVisible"
            v-if="inLiveDialogVisible"
            title="加入房间"
            width="20%"
            top="30vh"
            :close-on-click-modal="false"
            @close="closeInLiveDialog"
            class="select-none"
            :destroy-on-close="true"
        >
            <div class="px-2">
                <div class="flex w-full items-center mb-2">
                    <div class="w-1/6">房间号:</div>
                    <div class="w-5/6">
                        <el-input
                            class="w-full"
                            type="text"
                            placeholder="请输入房间号"
                            v-model="roomJoinForm.roomNumber"
                            maxlength="6"
                            show-word-limit
                        ></el-input>
                    </div>
                </div>

                <div class="flex w-full items-center mb-2">
                    <div class="w-1/6">密码:</div>
                    <div class="w-5/6">
                        <el-input
                            class="w-full"
                            type="text"
                            placeholder="请输入房间密码"
                            v-model="roomJoinForm.roomPassword"
                            maxlength="8"
                            show-word-limit
                        ></el-input>
                    </div>
                </div>

                <div class="w-full flex justify-center">
                    <el-button type="primary" @click="clickJoinRoom">加入</el-button>
                </div>
            </div>
        </el-dialog>

        <el-dialog
            :visible="loginDialogVisible"
            v-if="loginDialogVisible"
            width="350px"
            top="20vh"
            :close-on-click-modal="false"
            @close="closeLoginDialog"
            class="select-none"
            :destroy-on-close="true"
        >
            <el-form :model="loginForm" :rules="rules" ref="loginForm" class="demo-ruleForm" v-if="logintab === 0">
                <p class="form-title">请登录账户</p>
                <el-form-item label="邮箱" prop="email">
                    <el-input
                        class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg block w-full"
                        min="1"
                        v-model="loginForm.email"
                        placeholder="请输入邮箱"
                    ></el-input>
                </el-form-item>
                <el-form-item label="密码" prop="password">
                    <el-input
                        class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg block w-full"
                        min="1"
                        v-model="loginForm.password"
                        placeholder="请输入密码"
                    ></el-input>
                </el-form-item>
                <span
                    class="mt-2 w-full bg-blue-500 hover:bg-blue-700 font-medium rounded-lg text-sm px-5 py-2.5 text-center text-white"
                    type="submit"
                    @click="submitLogin('loginForm')"
                >
                    登录
                </span>

                <p class="signup-link mt-1">
                    没有帐户?
                    <a href="javascript:void(0);" @click="changeLoginTab()">注册</a>
                </p>
            </el-form>

            <el-form :model="registerForm" :rules="rules" ref="registerForm" class="demo-ruleForm" v-else>
                <p class="text-xl font-bold leading-tight tracking-tight text-gray-900 md:text-2xl mb-2">注册用户</p>
                <!-- <div class="flex justify-center">
                    <el-upload class="avatar-uploader" action="#" :show-file-list="false" list-type="picture-card" :auto-upload="false">
                         <i slot="default" class="el-icon-plus"></i>
                        <div slot="file" slot-scope="{ file }">
                            <img class="el-upload-list__item-thumbnail" :src="file.url" alt="" />
                        </div>
                    </el-upload>
                </div> -->
                <div class="flex items-center">
                    上传头像
                    <el-upload
                        class="avatar-uploader ml-2"
                        action="#"
                        :show-file-list="false"
                        :http-request="AutoUploadAvatar"
                        accept=".jpg, .png, .jpeg"
                    >
                        <img v-if="registerForm.url" :src="registerForm.url" class="avatar" />
                        <i v-else class="el-icon-plus avatar-uploader-icon"></i>
                    </el-upload>
                </div>
                <el-form-item label="用户名" prop="name">
                    <el-input
                        class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg block w-full"
                        min="1"
                        v-model="registerForm.name"
                        placeholder="请输入用户名"
                    ></el-input>
                </el-form-item>
                <el-form-item label="邮箱" prop="email">
                    <el-input
                        class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg block w-full"
                        min="1"
                        v-model="registerForm.email"
                        placeholder="请输入登陆邮箱"
                    ></el-input>
                </el-form-item>
                <el-form-item label="密码" prop="password">
                    <el-input
                        class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg block w-full"
                        min="1"
                        v-model="registerForm.password"
                        placeholder="请输入密码"
                    ></el-input>
                </el-form-item>
                <el-form-item label="确认密码" prop="confirmPassword">
                    <el-input
                        class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg block w-full"
                        min="1"
                        v-model="registerForm.confirmPassword"
                        placeholder="请确认密码"
                    ></el-input>
                </el-form-item>
                <p class="signup-link">
                    已有帐户?
                    <a href="javascript:void(0);" @click="changeLoginTab()">登录</a>
                </p>

                <span
                    class="w-full bg-blue-500 hover:bg-blue-700 font-medium rounded-lg text-sm px-5 py-2.5 text-center text-white"
                    type="submit"
                    @click="submitRegister('registerForm')"
                >
                    创建用户
                </span>
            </el-form>
        </el-dialog>
    </div>
</template>
<script>
var week = ['SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT'];
import { userStore } from '../../store/store';
import { Login, Register, UploadAvatar } from '../../api/user';
import { CreateRoom, JoinRoom } from '../../api/live';
import { uploadVideo, uploadLargeVideo, uploadVideoUrl, mergeVideo } from '../../api/videoTrans';
import { uploadFile } from '../../api/fileTrans';
import { getRecentRecord } from '../../api/record';
import { Message } from 'element-ui';
import bus from '../common/bus';
import SparkMD5 from 'spark-md5';
import { nanoid } from 'nanoid';
import { fileToBuffer, encodeWithSalt, decodeWithSalt, Salt } from '../../utils/util';
const userstore = userStore();
export default {
    mounted() {
        setInterval(this.startPlay, 7000);
        setInterval(this.updateTime, 1000);
        //请求最近的两条记录
        if (userstore.isLoggedIn === true) {
            getRecentRecord(userstore.user_id).then((res) => {
                console.log(res);
                for (let i = 0; i < res.singlerecords.length; i++) {
                    if (res.singlerecords[i].dataType > 1) {
                        res.singlerecords[i].title = JSON.parse(res.singlerecords[i].title);
                        res.singlerecords[i].keyword = JSON.parse(res.singlerecords[i].keyword);
                        res.singlerecords[i].updatetime = new Date(res.singlerecords[i].updatetime)
                            .toISOString()
                            .slice(0, 19)
                            .replace('T', ' ');
                    } else {
                        res.singlerecords[i].title = res.singlerecords[i].title;
                        res.singlerecords[i].keyword = JSON.parse(res.singlerecords[i].keyword);
                        res.singlerecords[i].updatetime = new Date(res.singlerecords[i].updatetime)
                            .toISOString()
                            .slice(0, 19)
                            .replace('T', ' ');
                    }
                }
                this.recent_items = res.singlerecords;
            });
        }
    },
    created() {
        bus.$on('openLogin', (msg) => {
            this.loginDialogVisible = msg;
        });
    },
    data() {
        var validatePass2 = (rule, value, callback) => {
            if (value === '') {
                callback(new Error('请再次输入密码'));
            } else if (value !== this.registerForm.password) {
                callback(new Error('两次输入密码不一致!'));
            } else {
                callback();
            }
        };
        return {
            ulList: [{ msg: '高效开会！' }, { msg: '轻松学习！' }, { msg: '随手总结！' }],
            play: false,
            recent_items: [
                {
                    dataType: 5,
                    id: 1,
                    keyword: { answer: [] },
                    title: { answer: '还没有最近的记录哦！' },
                    updatetime: ''
                },
                {
                    dataType: 5,
                    id: 2,
                    keyword: { answer: [] },
                    title: { answer: '还没有最近的记录哦！' },
                    updatetime: ''
                }
            ],
            date: '',
            time: '',
            videoDialogVisible: false,
            videoUploadDialogVisible: false,
            videoUrlUploadDialogVisible: false,
            docUploadDialogVisible: false,
            liveDialogVisible: false,
            createLiveDialogVisible: false,
            inLiveDialogVisible: false,
            loginDialogVisible: false,
            logintab: 0,
            videoFileList: [],
            fileFileList: [],
            videoFileCount: 0,

            //正在转写的文件列表  0表示正在上传,1表示上传成功,2表示上传失败 key:file_name,state,record_id
            UploadList: [],

            //上传音视频参数
            lang: '0', //视频语言类型
            transValue: 0, //是否翻译
            videoUrl: '',
            htmlUrl: '',
            docType: 0,
            docUploadDialogAcitveIndex: '0',

            roomJoinForm: {
                roomNumber: '',
                roomPassword: ''
            },
            roomCreateForm: {
                roomName: '',
                openLiveRadio: '0',
                roomPassword: '',
                liveRecordRadio: '0',
                roomNumber: ''
            },

            //上传中的组件
            openTrans: true,
            isUpload: false,
            uploadType: 0,

            loginForm: {
                email: '',
                password: ''
            },
            registerForm: {
                name: '',
                email: '',
                password: '',
                confirmPassword: '',
                url: ''
            },
            rules: {
                name: [
                    { required: true, message: '请输入用户名', trigger: 'blur' },
                    { min: 1, max: 8, message: '长度在 1 到 8 个字符', trigger: 'blur' }
                ],
                password: [
                    { required: true, message: '请输入密码', trigger: 'blur' },
                    { min: 1, max: 10, message: '长度在 1 到 10 个字符', trigger: 'blur' }
                ],
                email: [{ type: 'email', required: true, message: '请输入正确邮箱格式', trigger: 'blur' }],
                confirmPassword: [{ validator: validatePass2, trigger: 'blur' }]
            },
            uploadOptions: [
                {
                    value: 0,
                    label: '不翻译'
                },
                {
                    value: 1,
                    label: '英语'
                }
            ]
        };
    },
    watch: {
        UploadList: {
            immediate: true,
            deep: true,
            handler(newVal) {
                if (newVal.length > 0) {
                    this.isUpload = true;
                } else {
                    this.isUpload = false;
                }
                for (var i = 0; i < newVal.length; i++) {
                    if (newVal[i].state === 0) {
                        this.uploadType = 0;
                        return;
                    }
                }
                this.uploadType = 1;
            }
        }
    },
    methods: {
        startPlay() {
            let that = this;
            that.play = true; //开始播放
            setTimeout(() => {
                that.ulList.push(that.ulList[0]); //将第一条数据塞到最后一个
                that.ulList.shift(); //删除第一条数据
                that.play = false; //暂停播放,此处修改，保证每一次都会有动画显示
            }, 500);
        },
        updateTime() {
            let that = this;
            var cd = new Date();
            that.time =
                that.zeroPadding(cd.getHours(), 2) +
                ':' +
                that.zeroPadding(cd.getMinutes(), 2) +
                ':' +
                that.zeroPadding(cd.getSeconds(), 2);
            that.date =
                that.zeroPadding(cd.getFullYear(), 4) +
                '-' +
                that.zeroPadding(cd.getMonth() + 1, 2) +
                '-' +
                that.zeroPadding(cd.getDate(), 2) +
                ' ' +
                week[cd.getDay()];
        },
        zeroPadding(num, digit) {
            var zero = '';
            for (var i = 0; i < digit; i++) {
                zero += '0';
            }
            return (zero + num).slice(-digit);
        },
        rename() {
            if (!userstore.isLogin) {
                this.loginDialogVisible = true;
                return;
            }
            this.$prompt('重命名', {
                confirmButtonText: '确定',
                cancelButtonText: '取消',
                inputPattern: /^[^\n]{1,150}$/,
                inputErrorMessage: '命名不能为空,不能带有回车，最大长度为150字符',
                inputType: 'textarea',
                inputValue: this.recent_items[0]
            })
                .then(({ value }) => {
                    this.$message({
                        type: 'success',
                        message: '你的邮箱是: ' + value
                    });
                })
                .catch(() => {
                    this.$message({
                        type: 'info',
                        message: '取消输入'
                    });
                });
        },
        closeVideoDialog() {
            this.videoDialogVisible = false;
        },
        closeVideoUploadDialog() {
            this.videoUploadDialogVisible = false;
            this.uploadOptions[1].label = '英语';
            this.lang = '0';
            this.transValue = 0;
            this.fileCount = 0;
        },
        closeVideoUrlUploadDialog() {
            this.videoUrlUploadDialogVisible = false;
            this.videoUrl = '';
        },
        closeDocUploadDialog() {
            this.docUploadDialogVisible = false;
            this.htmlUrl = '';
        },
        closeLiveDialog() {
            this.liveDialogVisible = false;
        },
        closeInLiveDialog() {
            this.inLiveDialogVisible = false;
            this.roomJoinForm.roomNumber = '';
            this.roomJoinForm.roomPassword = '';
        },
        closeCreateLiveDialog() {
            this.createLiveDialogVisible = false;
            this.roomCreateForm.roomName = '';
            this.roomCreateForm.roomNumber = '';
            this.roomCreateForm.roomPassword = '';
        },
        closeLoginDialog() {
            this.loginDialogVisible = false;
            this.logintab = 0;
        },
        // 处理移除操作
        async handleVideoChange(file, fileList) {
            this.videoFileCount = fileList.length;
        },
        async handleVideoRemove(file, fileList) {
            this.videoFileCount = fileList.length;
        },
        handleVideoSuccess() {
            this.$refs.videoUpload.clearFiles();
        },
        // 处理超出图片个数操作
        handleVideoExceed(files, fileList) {
            this.$message.warning(
                `当前限制选择 5 个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`
            );
        },
        changeLang() {
            if (this.lang == '0') {
                this.uploadOptions[1].label = '英语';
            } else {
                this.uploadOptions[1].label = '中文';
            }
        },
        isValidUrl() {
            const regex =
                /^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/;
            return regex.test(this.link);
        },
        handleDocTypeSelect(key, keyPath) {
            this.docUploadDialogAcitveIndex = key;
            this.htmlUrl = '';
            console.log(this.docUploadDialogAcitveIndex);
        },
        clickTrans() {
            this.openTrans = !this.openTrans;
        },
        handleCheckAllChange(val) {
            this.checkedCities = val ? cityOptions : [];
            this.isIndeterminate = false;
        },
        handleCheckedCitiesChange(value) {
            let checkedCount = value.length;
            this.checkAll = checkedCount === this.cities.length;
            this.isIndeterminate = checkedCount > 0 && checkedCount < this.cities.length;
        },
        generateRandomString() {
            return Math.floor(Math.random() * 100000).toString();
        },
        copyRoomNumber() {
            const value = document.getElementById('roomNumber').innerText;
            this.$copyText(value).then((e) => {
                console.log('复制成功：', e);
            });
        },
        opendialog(name) {
            if (!userstore.isLoggedIn) {
                this.loginDialogVisible = true;
                return;
            }
            var variable = name + 'Visible';
            this[variable] = true;
        },
        goToVoiceRecord() {
            if (!userstore.isLoggedIn) {
                this.loginDialogVisible = true;
                return;
            }
            this.$router.push('/voice-record');
        },
        changeLoginTab() {
            if (this.logintab == 1) {
                this.logintab = 0;
                return;
            }
            this.logintab = 1;
        },
        submitRegister(formName) {
            this.$refs[formName].validate((valid) => {
                if (valid) {
                    //注册成功
                    Register(this.registerForm.email, this.registerForm.password, this.registerForm.name, this.registerForm.url).then(
                        (response) => {
                            if (response.code === 200) {
                                Message.success('注册成功');
                                this.closeLoginDialog();
                                this.resetRgisterForm();
                            }
                        }
                    );
                } else {
                    //注册失败
                    console.log('error submit!!');
                    return false;
                }
            });
        },
        submitLogin(formName) {
            this.$refs[formName].validate((valid) => {
                if (valid) {
                    //登录成功
                    Login(this.loginForm.email, this.loginForm.password).then((response) => {
                        if (response.code === 200) {
                            Message.success('登录成功');
                            // this.closeLoginDialog();
                            // this.resetLoginForm();
                            userstore.isLoggedIn = true;
                            userstore.user_id = response.UserId;
                            // userstore.avatar = response.Avatar
                            userstore.avatar = response.Avatar;
                            userstore.name = response.Name;
                            userstore.token = response.Token.access_token;
                            console.log(response);
                            console.log(userstore);
                            window.location.reload();
                        }
                    });
                } else {
                    //登录失败
                    console.log('error submit!!');
                    return false;
                }
            });
        },
        resetLoginForm() {
            this.loginForm = {
                email: '',
                password: ''
            };
        },
        resetRgisterForm() {
            this.registerForm = {
                name: '',
                email: '',
                password: '',
                confirmPassword: '',
                avatar: ''
            };
        },
        // 上传(同时选择多个文件时会多次上传该文件)
        async handleVideoFileUpload(item) {
            let file = item.file;
            var tag = nanoid(4);
            //进度列表添加
            this.UploadList.push({
                tag: tag,
                file_name: file.name,
                state: 0,
                record_id: -1
            });

            // 文件大于5mb时分片上传
            if (file.size / 1024 / 1024 < 5) {
                const formData = new FormData();
                formData.append('file', file); //文件
                formData.append('filename', file.name); //文件名
                formData.append('user_id', userstore.user_id);
                if (this.lang === '0') {
                    formData.append('source_language', 'zh-CHS');
                    formData.append('dest_language', 'en');
                } else {
                    formData.append('source_language', 'en');
                    formData.append('dest_language', 'zh-CHS');
                }

                if (file.type === 'audio/mpeg' || file.type === 'audio/mp3') {
                    formData.append('type', 0);
                } else {
                    formData.append('type', 1);
                }
                var spark = new SparkMD5.ArrayBuffer();
                function getMd5(file) {
                    return new Promise((resolve) => {
                        // 对文件对象的处理
                        var fileReader = new FileReader();
                        fileReader.readAsArrayBuffer(file);
                        // fileReader.onload为异步函数，要放到Promise对象中，等待状态的变更后再返回生成的md5值
                        fileReader.onload = function (e) {
                            spark.append(e.target.result);
                            resolve(spark.end());
                        };
                    });
                }
                let md5 = await getMd5(file);
                formData.append('md5', md5);
                uploadVideo(formData) //调用api
                    .then((res) => {
                        if (res.code === 200) {
                            this.SetUploadSuccess(tag, res.record_id);
                            Message.success(`${file.name}：转写完成`);
                        } else {
                            this.SetUploadError(tag);
                            Message.error(`${file.name}：转写失败`);
                        }
                    });
            } else {
                const size = 5 * 1024 * 1024; // 5MB 每个分片大小
                let current = 0; // 当前分片index(从0开始)
                let total = Math.ceil(file.size / size); // 分片总数
                let startByte = 0;
                let that = this;
                // 通过文件获取对应的md5值
                let dataFileStart = file.slice(0, size); // 第一片文件
                let dataFileEnd = file.slice(size * (total - 1), file.size); // 最后一片文件
                var spark = new SparkMD5.ArrayBuffer();
                function getMd5(file) {
                    return new Promise((resolve) => {
                        // 对文件对象的处理
                        var fileReader = new FileReader();
                        fileReader.readAsArrayBuffer(file);
                        // fileReader.onload为异步函数，要放到Promise对象中，等待状态的变更后再返回生成的md5值
                        fileReader.onload = function (e) {
                            spark.append(e.target.result);
                            resolve(spark.end());
                        };
                    });
                }
                //获取文件二进制数据
                let md5Start = await getMd5(dataFileStart); // 第一片的md5值
                let md5End = await getMd5(dataFileEnd); // 最后一片的md5值
                let md5 = md5Start + md5End;

                //上传一次
                uploadChunk();
                // 文件完整性检测，完整则合并
                let mergeTime = 0;
                let type;
                if (file.type === 'audio/mpeg' || file.type === 'audio/mp3') {
                    type = '0';
                } else {
                    type = '1';
                }
                let source_language, dest_language;
                if (this.lang === '0') {
                    source_language = 'zh-CHS';
                    dest_language = 'en';
                } else {
                    dest_language = 'zh-CHS';
                    source_language = 'en';
                }
                function merge() {
                    mergeVideo(md5, total.toString(), file.name, userstore.user_id.toString(), type, source_language, dest_language).then(
                        (res) => {
                            if (res.code === 200) {
                                if (res.idx != -1) {
                                    current = res.idx; // 当前服务器应该上传的分片下标
                                    startByte = size * current;
                                    uploadChunk();
                                    if (mergeTime <= 5) {
                                        mergeTime += 1;
                                        merge();
                                        return;
                                    } else {
                                        Message.error('文件合并失败,请重新上传');
                                        return;
                                    }
                                }
                                that.SetUploadSuccess(tag, res.record_id);
                                Message.success(`${file.name}：转写完成`);
                            } else {
                                that.SetUploadError(tag);
                                Message.error(`${file.name}：转写失败`);
                            }
                        }
                    );
                }
                // .finally(() => {
                //     this.disabled = false;
                // });

                // 编辑上传参数并上传文件
                function uploadChunk() {
                    const formData = new FormData();
                    const endByte = Math.min(startByte + size, file.size);
                    const chunk = file.slice(startByte, endByte); // 当前分片文件
                    formData.append('file', chunk);
                    formData.append('filename', file.name);
                    formData.append('current', current);
                    formData.append('total', total);
                    formData.append('md5', md5);
                    formData.append('user_id', userstore.user_id);
                    if (file.type === 'audio/mpeg' || file.type === 'audio/mp3') {
                        formData.append('type', 0);
                    } else {
                        formData.append('type', 1);
                    }

                    uploadLargeVideo(formData)
                        .then((res) => {
                            console.log('res', res);
                            if (res.code === 200) {
                                //前一个文件片上传成功
                                console.log('前一个上传成功');
                                // that.list.forEach((item) => {
                                //     if (item.name === file.name) {
                                //         item.percent = Math.floor(((Number(current) + 1) * 100) / total);
                                //     }
                                // });
                                // that.list = [...that.list];
                                startByte = endByte;
                                if (startByte < file.size) {
                                    current++;
                                    uploadChunk();
                                } else {
                                    merge();
                                }
                            } else {
                                Message.error(`${file.name}：上传失败`);
                            }
                        })
                        .finally(() => {
                            that.disabled = false;
                        });
                }
            }
            return false;
        },
        clickUploadVideo() {
            console.log('点击');
            this.$refs.videoUpload.submit();
            this.closeVideoUploadDialog();
        },
        submitVideoUrl() {
            var tag = nanoid(4);
            //进度列表添加
            this.UploadList.push({
                tag: tag,
                file_name: this.videoUrl,
                state: 0,
                record_id: -1
            });
            uploadVideoUrl(this.videoUrl, userstore.user_id).then((res) => {
                if (res.code === 200) {
                    this.SetUploadSuccess(tag, res.record_id);
                    Message.success(`${file.name}：转写完成`);
                } else {
                    this.SetUploadError(tag);
                    Message.error(`${file.name}：转写失败`);
                }
            });
            this.closeVideoUrlUploadDialog();
        },
        clickCreateRoom() {
            let is_record = false;
            if (this.roomCreateForm.liveRecordRadio === '0') {
                is_record = true;
            }
            let is_open = false;
            if (this.roomCreateForm.openLiveRadio === '0') {
                is_open = true;
            }
            CreateRoom(
                this.roomCreateForm.roomName,
                is_open,
                this.roomCreateForm.roomPassword,
                is_record,
                this.roomCreateForm.roomNumber,
                userstore.user_id,
                userstore.name,
                userstore.avatar
            ).then((res) => {
                if (res.code === 200) {
                    var index = res.url.lastIndexOf('/');
                    var url = res.url.slice(0, index);
                    var pushNumber = res.url.slice(index + 1);
                    const h = this.$createElement;
                    this.$msgbox({
                        title: '创建成功',
                        message: h('div', null, [
                            h('div', null, '请使用推流工具进行推流,您的推流地址如下:'),
                            h('div', { style: 'word-break: break-all;word-wrap: break-word' }, '服务器:' + url),
                            h('div', { style: 'word-break: break-all;word-wrap: break-word' }, '推流码:' + pushNumber),
                            h('div', null, `用户将通过您的房间号加入直播，您的房间号为:${this.roomCreateForm.roomNumber}`),
                            h('div', null, `实时字幕地址:http://localhost:8080/#/subtitle`)
                        ]),
                        confirmButtonText: '确定'
                    });
                    this.closeCreateLiveDialog();
                }
            });
        },
        clickJoinRoom() {
            JoinRoom(this.roomJoinForm.roomNumber, this.roomJoinForm.roomPassword).then((res) => {
                console.log(res);
                if (res.code === 200) {
                    this.$router.push({
                        path: '/live',
                        query: { rn: this.roomJoinForm.roomNumber, pw: encodeWithSalt(this.roomJoinForm.roomPassword, Salt) }
                    });
                }
            });
        },
        AutoUploadAvatar(file) {
            var dataform = new FormData();
            dataform.append('file', file.file);
            dataform.append('file_name', file.file.name);
            UploadAvatar(dataform).then((res) => {
                if (res.code === 200) {
                    Message.success('头像上传成功');
                    this.registerForm.url = res.url;
                } else {
                    Message.error('头像上传失败');
                }
            });
        },
        async handleFileFileUpload(item) {
            let file = item.file;
            var tag = nanoid(4);
            //进度列表添加
            this.UploadList.push({
                tag: tag,
                file_name: file.name,
                state: 0,
                record_id: -1
            });
            // 文件大于5mb时分片上传
            const formData = new FormData();
            formData.append('file', file); //文件
            formData.append('name', file.name); //文件名
            formData.append('user_id', userstore.user_id);

            console.log(file.type);
            if (file.type === 'image/jpeg' || file.type === 'image/png') {
                formData.append('type', 4);
            } else if (file.type === 'application/pdf') {
                formData.append('type', 2);
            } else if (
                file.type === 'application/msword' ||
                file.type === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'
            ) {
                formData.append('type', 3);
            }

            var spark = new SparkMD5.ArrayBuffer();
            function getMd5(file) {
                return new Promise((resolve) => {
                    // 对文件对象的处理
                    var fileReader = new FileReader();
                    fileReader.readAsArrayBuffer(file);
                    // fileReader.onload为异步函数，要放到Promise对象中，等待状态的变更后再返回生成的md5值
                    fileReader.onload = function (e) {
                        spark.append(e.target.result);
                        resolve(spark.end());
                    };
                });
            }
            let md5 = await getMd5(file);
            formData.append('md5', md5);
            uploadFile(formData) //调用api
                .then((res) => {
                    if (res.code === 200) {
                        this.SetUploadSuccess(tag, res.record_id);
                        Message.success(`${file.name}：转写完成`);
                    } else {
                        this.SetUploadError(tag);
                        Message.error(`${file.name}：转写失败`);
                    }
                });
            this.closeDocUploadDialog();
        },
        submitFileURL() {
            var tag = nanoid(4);
            //进度列表添加
            this.UploadList.push({
                tag: tag,
                file_name: this.htmlUrl,
                state: 0,
                record_id: -1
            });
            const formData = new FormData();
            formData.append('url', this.htmlUrl); //网页名
            formData.append('user_id', userstore.user_id);
            formData.append('type', 5);
            uploadFile(formData) //调用api
                .then((res) => {
                    if (res.code === 200) {
                        this.SetUploadSuccess(tag, res.record_id);
                        Message.success(`${this.htmlUrl}：转写完成`);
                    } else {
                        this.SetUploadError(tag);
                        Message.error(`${this.htmlUrl}：转写失败`);
                    }
                });
            this.closeDocUploadDialog();
        },
        clickToRecord(record_id) {
            if (!userstore.isLoggedIn) {
                this.loginDialogVisible = true;
                return;
            }
            console.log(record_id);
            this.$router.push({
                path: '/transcript',
                query: { id: encodeWithSalt(record_id, Salt) }
            });
        },
        SetUploadSuccess(tag, record_id) {
            for (var i = 0; i < this.UploadList.length; i++) {
                if (this.UploadList[i].tag === tag) {
                    this.UploadList[i].state = 1;
                    this.UploadList[i].record_id = record_id;
                    break;
                }
            }
        },
        SetUploadError(tag) {
            for (var i = 0; i < this.UploadList.length; i++) {
                if (this.UploadList[i].tag === tag) {
                    this.UploadList[i].state = 2;
                    break;
                }
            }
        },
        deleteUploadList(i) {
            this.UploadList = this.UploadList.filter((element, index) => index !== i);
        }
    }
};
</script>
 
<style scoped>
.toUp {
    margin-top: -96px;
    transition: all 0.5s;
    z-index: 1;
}

.scroll {
    overflow: hidden;
}

.bg {
    /* background: url(//g.alicdn.com/idst-fe/mind-meeting-assistant2/0.0.204/static/mask.4122db2d.png) 0px 0px no-repeat; */
    background: url(../../assets/img/homepage.webp) 0px 0px no-repeat;
    height: 1200px;
    width: 100%;
    background-size: cover !important;
    position: absolute;
    user-select: none;
    filter: blur(2px);
}

.bg_gif {
    /* background: url(//g.alicdn.com/idst-fe/mind-meeting-assistant2/0.0.204/static/mask.4122db2d.png) 0px 0px no-repeat; */
    background: url(../../assets/img/home_gif.gif) 0px 0px no-repeat;
    background-size: 500px;
    position: absolute;
    top: 0px;
    right: 400px;
    width: 500px;
    height: 278px;
    user-select: none;
}

.hcard {
    width: 424px;
}

.hcard:hover .hover_svg {
    opacity: 1 !important;
    transition: all 0.2s ease-in 0s;
}

.meet_bg {
    background-image: url(../../assets/img/meeting.jpg);
    background-size: 100% 100%;
    user-select: none;
}

.class_bg {
    background-image: url(../../assets/img/class.png);
    background-size: 100% 100%;
    user-select: none;
}

.doc_bg {
    background-image: url(../../assets/img/doc.png);
    background-size: 100% 100%;
    user-select: none;
}

.live_bg {
    background-image: url(../../assets/img/live.png);
    background-size: 100% 100%;
    user-select: none;
}

.rencent_title {
    display: -webkit-box;
    line-height: 1.5;
    overflow: hidden;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    word-break: break-all;
    font-family: PingFangSC-Medium;
}

/* .recent_box{
background: #f1f1f1;
border-radius: 10px;
  background-image: 
    linear-gradient(#e1e1e1 0.1em, transparent 0.1em);
  background-size: 100% 30px;
} */

.clock {
    /* transform: translate(-50%, -50%); */
    color: #18aff5;
    text-shadow: 0 0 20px rgb(23, 170, 219), 0 0 20px rgba(169, 222, 240, 0.89);
}

.time {
    letter-spacing: 0.05em;
    font-size: 80px;
    padding: 5px 0;
    user-select: none;
}
.date {
    letter-spacing: 0.1em;
    font-size: 24px;
    user-select: none;
}

.rec_icon {
    display: flex;
    -webkit-box-align: center;
    align-items: center;
    -webkit-box-pack: justify;
    justify-content: space-between;
    height: 24px;
    padding: 0 5px;
    min-width: 24px;
    max-width: 24px;
    min-height: 24px;
    max-height: 24px;
    border-radius: 4px;
}

.label_b {
    transition: all 0.1s ease-in 0s;
}

.hover_card:hover .label_b {
    opacity: 1;
}
.collectIconWrap {
    display: none;
}

.hover_card:hover .collectIconWrap {
    display: flex;
}

.hover_card:hover .iconHoverWrap {
    display: none;
}

.videodialogcard {
    height: 110px;
    width: 85%;
    margin-top: 20px;
    margin-left: auto;
    margin-right: auto;
    border-radius: 14px;
    padding: 8px;
}

::v-deep .el-radio-button__inner {
    width: 83px;
    height: 36px;
    border: 1 !important;
    border-radius: 2px;
    font-size: 14px;
    font-weight: 400;
    color: #696969;
    line-height: 14px;
    outline: none;
    box-shadow: none;
}
/*激活样式*/
::v-deep .el-radio-button__orig-radio:checked + .el-radio-button__inner {
    background: #74baff;
    border: 0 !important;
    color: #ffffff;
    line-height: 14px;
    outline: none;
    box-shadow: none;
}

.el-menu--horizontal >>> .el-menu-item:not(.is-disabled):hover {
    background: transparent !important;
}

.hoverTrans:hover {
    margin-right: 0;
    transition: all 0.2s ease-in 0s;
}

.closeTrans {
    margin-right: -128px;
    transition: all 0.2s ease-in 0s;
}

.transListContainer {
    transition: opacity 0.3s;
}

.el-form {
    background-color: #fff;
    display: block;
    padding: 1rem;
    max-width: 350px;
    border-radius: 0.5rem;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

.form-title {
    font-size: 1.25rem;
    line-height: 1.75rem;
    font-weight: 600;
    text-align: center;
    color: #000;
}

.input-container {
    position: relative;
}

.submit {
    display: block;
    padding-top: 0.75rem;
    padding-bottom: 0.75rem;
    padding-left: 1.25rem;
    padding-right: 1.25rem;
    background-color: #4f46e5;
    color: #ffffff;
    font-size: 0.875rem;
    line-height: 1.25rem;
    font-weight: 500;
    width: 100%;
    border-radius: 0.5rem;
    text-transform: uppercase;
}

.signup-link {
    color: #6b7280;
    font-size: 0.875rem;
    line-height: 1.25rem;
    text-align: center;
}

.signup-link a {
    text-decoration: underline;
}

::v-deep .el-upload--picture-card {
    width: 100px;
    height: 100px;
}
::v-deep .avatar-uploader .el-upload {
    width: 100px;
    height: 100px;
    line-height: 100px;
}
::v-deep .el-upload-list--picture-card .el-upload-list__item {
    width: 100px;
    height: 100px;
    line-height: 100px;
}
::v-deep .el-upload-list--picture-card .el-upload-list__item-thumbnail {
    width: 100px;
    height: 100px;
    line-height: 100px;
}
::v-deep .avatar {
    width: 100px;
    height: 100px;
}

.loader {
    display: block;
    --height-of-loader: 4px;
    --loader-color: rgb(36, 167, 255);
    width: 100%;
    height: var(--height-of-loader);
    border-radius: 30px;
    background-color: rgba(0, 0, 0, 0.2);
    position: relative;
}

.loader::before {
    content: '';
    position: absolute;
    background: var(--loader-color);
    top: 0;
    left: 0;
    width: 0%;
    height: 100%;
    border-radius: 30px;
    animation: moving 1s ease-in-out infinite;
}

@keyframes moving {
    50% {
        width: 100%;
    }

    100% {
        width: 0;
        right: 0;
        left: unset;
    }
}
</style>
